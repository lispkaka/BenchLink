# 性能测试菜单设计方案

## 设计理念

参考 `test.html` 的实时仪表盘风格和 `Dashboard.vue` 的标签页切换方式，设计一个**轻量级但功能完善的性能测试模块**。

## 菜单结构（推荐）

### 单一菜单 + 标签页切换

```
性能测试
└── 性能测试仪表盘 (/performance/dashboard)
    ├── 实时监控 (标签页1)
    ├── 任务管理 (标签页2)
    └── 历史报告 (标签页3)
```

## 功能模块设计

### 1. 实时监控（标签页1）- 核心功能 ⭐

**参考 `test.html` 的设计风格**

#### 顶部控制栏
- 当前运行状态（运行中/已停止）
- 当前测试任务名称
- 测试持续时间
- 当前并发数
- 停止/暂停按钮（如果正在运行）

#### 测试概览卡片（4个指标）
- **开始时间**：测试开始的时间
- **总请求数**：累计发送的请求总数
- **峰值 RPS**：测试过程中的最高 RPS
- **当前 RPS**：实时每秒请求数

#### 主指标区域（3列布局）

**1. 响应时间**
- 平均响应时间（大字体显示）
- 最快/最慢响应时间
- 响应时间趋势图（折线图，显示最近60秒）

**2. 吞吐量 & 错误率**
- 当前 RPS（大字体显示）
- 成功率百分比
- 错误次数
- RPS 趋势图（折线图）

**3. 系统资源**
- CPU 使用率（进度条）
- 内存使用率（进度条）
- 网络带宽使用率（进度条）

#### 响应时间分布（直方图）
- 按时间段分布：<100ms, 100-200ms, 200-500ms, 500ms-1s, >1s
- 不同颜色表示不同时间段

#### 阈值警报条
- 如果资源使用率超过阈值，显示警告信息

#### 功能特点
- ✅ 实时更新（WebSocket 或轮询）
- ✅ 可视化图表（Chart.js 或 ECharts）
- ✅ 简洁美观的卡片布局

---

### 2. 任务管理（标签页2）- 轻量级管理

**参考当前的 `PerformanceTaskList.vue` 但更简洁**

#### 顶部操作区
- 项目筛选下拉框
- **新建任务**按钮（打开对话框，不跳转）

#### 任务列表表格
- 任务名称
- 关联接口
- 所属项目
- 并发配置（线程数、启动时间、持续时间）
- 最新结果（状态、TPS、平均响应时间）
- 执行时间
- 操作列：**编辑**、**执行**、**查看结果**、**删除**

#### 创建/编辑对话框
- 任务基本信息（名称、项目、接口、环境）
- 性能参数（并发数、启动时间、持续时间、循环次数）
- 描述（可选）
- 保存后关闭对话框，刷新列表

#### 执行结果对话框
- 执行完成后弹出
- 显示详细性能指标
- 可查看 HTML 报告链接

#### 功能特点
- ✅ 所有操作在一个页面完成（对话框形式）
- ✅ 无需页面跳转
- ✅ 快速创建和执行

---

### 3. 历史报告（标签页3）- 报告查看

**参考 `PerformanceReports.vue` 但更简洁**

#### 顶部筛选区
- 任务筛选下拉框
- 时间范围选择（今天、最近7天、最近30天）

#### 报告列表
- 任务名称
- 执行时间
- 测试状态（成功/失败）
- 关键指标（总样本、TPS、平均响应时间、错误率）
- 操作：**查看详情**、**查看HTML报告**

#### 报告详情对话框
- 详细的性能指标展示
- 图表展示（可选）
- 错误信息

#### 功能特点
- ✅ 按时间排序
- ✅ 快速筛选
- ✅ 详细指标查看

---

## 完整菜单结构

```
性能测试
└── 性能测试仪表盘 (/performance/dashboard)
    └── 标签页切换：
        ├── 📊 实时监控（默认）
        ├── 📋 任务管理
        └── 📈 历史报告
```

## 用户体验流程

### 场景1：执行性能测试并实时查看

```
1. 进入"性能测试仪表盘"
   ↓
2. 切换到"任务管理"标签页
   ↓
3. 点击"新建任务" → 填写配置 → 保存
   ↓
4. 点击"执行"按钮
   ↓
5. 自动切换到"实时监控"标签页
   ↓
6. 实时查看测试进度和指标
   ↓
7. 测试完成后，可以切换到"历史报告"查看详细报告
```

### 场景2：查看历史报告

```
1. 进入"性能测试仪表盘"
   ↓
2. 切换到"历史报告"标签页
   ↓
3. 筛选任务或时间范围
   ↓
4. 点击"查看详情"查看详细指标
```

## 技术实现建议

### 前端
- **主页面**：`PerformanceDashboard.vue`
  - 使用 `el-tabs` 实现标签页切换
  - 三个子组件：
    - `PerformanceMonitor.vue` - 实时监控
    - `PerformanceTasks.vue` - 任务管理
    - `PerformanceReports.vue` - 历史报告

### 后端
- **实时数据**：WebSocket 或轮询接口
- **任务管理**：现有的 `PerformanceTestViewSet`
- **报告存储**：可以考虑独立的报告模型（可选）

## 设计优势

### ✅ 轻量级
- 只有1个菜单项
- 功能集中，不分散
- 标签页切换，操作流畅

### ✅ 功能完整
- 实时监控（核心功能）
- 任务管理（基础功能）
- 历史报告（查询功能）

### ✅ 用户体验好
- 执行任务后自动切换到实时监控
- 无需页面跳转
- 所有功能在一个页面完成

### ✅ 符合轻量级定位
- 去掉复杂的脚本管理
- 去掉不必要的功能
- 聚焦核心：监控、管理、报告

## 对比其他方案

| 方案 | 菜单数量 | 页面跳转 | 复杂度 | 推荐度 |
|------|---------|---------|--------|--------|
| 当前方案（4个菜单） | 4个 | 需要跳转 | 较高 | ⭐⭐ |
| 2个菜单方案 | 2个 | 部分跳转 | 中等 | ⭐⭐⭐ |
| **1个菜单+标签页** | **1个** | **无需跳转** | **低** | **⭐⭐⭐⭐⭐** |

## 总结

**推荐方案：1个菜单 + 3个标签页**

- **菜单**：性能测试仪表盘
- **标签页1**：实时监控（核心，参考test.html）
- **标签页2**：任务管理（轻量级CRUD）
- **标签页3**：历史报告（查看历史数据）

这样既保持了轻量级定位，又提供了完整的功能，用户体验也最好。

