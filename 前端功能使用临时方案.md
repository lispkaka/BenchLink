# æ–°åŠŸèƒ½å‰ç«¯ä½¿ç”¨ä¸´æ—¶æ–¹æ¡ˆ

## å½“å‰çŠ¶æ€

âœ… **åç«¯APIå·²å®Œå…¨å®ç°**  
â³ **å‰ç«¯ç•Œé¢æ­£åœ¨å¼€å‘ä¸­**

ç”±äºå‰ç«¯ç•Œé¢å¼€å‘éœ€è¦è¾ƒå¤šæ—¶é—´ï¼Œæ‚¨å¯ä»¥å…ˆé€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨æ–°åŠŸèƒ½ï¼š

---

##  1. Cookieè‡ªåŠ¨ç®¡ç† âœ… **å·²è‡ªåŠ¨ç”Ÿæ•ˆ**

**æ— éœ€ä»»ä½•æ“ä½œï¼**

Cookieç®¡ç†å·²ç»åœ¨åç«¯è‡ªåŠ¨å·¥ä½œï¼Œå½“æ‚¨æ‰§è¡Œæµ‹è¯•å¥—ä»¶æ—¶ï¼š
- ç¬¬ä¸€ä¸ªç”¨ä¾‹çš„å“åº”Cookieä¼šè‡ªåŠ¨ä¿å­˜
- åç»­ç”¨ä¾‹è‡ªåŠ¨æºå¸¦è¿™äº›Cookie
- Cookieè¿‡æœŸä¼šè‡ªåŠ¨æ¸…ç†

### æµ‹è¯•æ–¹æ³•
1. åˆ›å»ºä¸€ä¸ªç™»å½•æ¥å£çš„æµ‹è¯•ç”¨ä¾‹
2. åˆ›å»ºä¸€ä¸ªéœ€è¦ç™»å½•çš„æ¥å£æµ‹è¯•ç”¨ä¾‹  
3. å°†ä¸¤ä¸ªç”¨ä¾‹åŠ å…¥åŒä¸€ä¸ªæµ‹è¯•å¥—ä»¶
4. æ‰§è¡Œæµ‹è¯•å¥—ä»¶ â†’ Cookieè‡ªåŠ¨å…±äº«

---

## 2. æ–‡ä»¶ä¸Šä¼ æ”¯æŒ ğŸ“ **å¯é€šè¿‡APIæˆ–æ•°æ®åº“é…ç½®**

### æ–¹å¼ä¸€ï¼šç›´æ¥ä¿®æ”¹æ•°æ®åº“ï¼ˆæ¨èå¿«é€Ÿæµ‹è¯•ï¼‰

```sql
-- ä¸ºæŸä¸ªAPIé…ç½®æ–‡ä»¶ä¸Šä¼ 
UPDATE apis_api 
SET files = '{
  "file": {
    "file_path": "/Users/admin/test.jpg",
    "content_type": "image/jpeg"
  }
}'
WHERE id = 1;

-- æˆ–ä¸ºæµ‹è¯•ç”¨ä¾‹è¦†ç›–é…ç½®
UPDATE testcases_testcase
SET files_override = '{
  "avatar": {
    "file_path": "/Users/admin/avatar.png",
    "content_type": "image/png"
  }
}'
WHERE id = 1;
```

### æ–¹å¼äºŒï¼šé€šè¿‡Django Adminåå°

1. è®¿é—®: http://127.0.0.1:8000/admin/
2. è¿›å…¥ APIs æˆ– Test Cases
3. ç¼–è¾‘å¯¹åº”è®°å½•ï¼Œåœ¨ `files` æˆ– `files_override` å­—æ®µè¾“å…¥JSONé…ç½®

### é…ç½®æ ¼å¼

```json
{
  "å­—æ®µå": {
    "file_path": "æ–‡ä»¶ç»å¯¹è·¯å¾„",
    "content_type": "MIMEç±»å‹"
  }
}
```

**ç¤ºä¾‹**:
```json
{
  "avatar": {
    "file_path": "/Users/admin/Documents/test.jpg",
    "content_type": "image/jpeg"
  },
  "document": {
    "file_path": "/Users/admin/Documents/report.pdf",
    "content_type": "application/pdf"
  }
}
```

---

## 3. æ¥å£å¯¼å…¥/å¯¼å‡º ğŸ”§ **å¯é€šè¿‡APIå·¥å…·è°ƒç”¨**

### ä½¿ç”¨Postmanã€cURLæˆ–å…¶ä»–APIå·¥å…·

#### 1) å¯¼å…¥Postman Collection

```bash
curl -X POST http://127.0.0.1:8000/api/apis/apis/import_postman/ \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "project_id": 1,
    "collection": {
      "info": {
        "name": "My Collection",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
      },
      "item": [...]
    }
  }'
```

#### 2) å¯¼å…¥Swagger/OpenAPI

```bash
curl -X POST http://127.0.0.1:8000/api/apis/apis/import_swagger/ \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "project_id": 1,
    "spec": {
      "openapi": "3.0.0",
      "info": {...},
      "paths": {...}
    }
  }'
```

#### 3) å¯¼å‡ºä¸ºPostman Collection

```bash
# ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®æˆ–ç”¨curlä¸‹è½½
curl -X GET "http://127.0.0.1:8000/api/apis/apis/export_postman/?project_id=1" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -o exported_collection.json
```

### Postman ä½¿ç”¨

1. æ‰“å¼€Postman
2. åˆ›å»ºæ–°è¯·æ±‚
3. è®¾ç½®ä¸º POST `http://127.0.0.1:8000/api/apis/apis/import_postman/`
4. åœ¨Headersæ·»åŠ è®¤è¯token
5. åœ¨Bodyé€‰æ‹©raw/JSONï¼Œç²˜è´´Collectionæ•°æ®
6. å‘é€è¯·æ±‚

---

## 4. æµ‹è¯•æŠ¥å‘Šå¯¼å‡º ğŸ“Š **å¯ç›´æ¥è®¿é—®URLä¸‹è½½**

### æ–¹å¼ä¸€ï¼šæµè§ˆå™¨ç›´æ¥è®¿é—®

```
http://127.0.0.1:8000/api/executions/executions/{execution_id}/export_report/
```

å°†`{execution_id}`æ›¿æ¢ä¸ºå®é™…çš„æ‰§è¡Œè®°å½•IDï¼Œä¾‹å¦‚ï¼š
```
http://127.0.0.1:8000/api/executions/executions/123/export_report/
```

### æ–¹å¼äºŒï¼šä½¿ç”¨cURLä¸‹è½½

```bash
curl -X GET "http://127.0.0.1:8000/api/executions/executions/123/export_report/" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -o test_report.html
```

### å¦‚ä½•è·å–execution_idï¼Ÿ

1. åœ¨å‰ç«¯æ‰§è¡Œè®°å½•é¡µé¢ï¼Œç‚¹å‡»æŸæ¡è®°å½•æŸ¥çœ‹è¯¦æƒ…
2. æµè§ˆå™¨URLä¸­çš„IDå³ä¸ºexecution_id
3. æˆ–é€šè¿‡APIè·å–: `GET /api/executions/executions/`

---

## å‰ç«¯ç•Œé¢å¼€å‘è®¡åˆ’

æˆ‘æ­£åœ¨ä¸ºæ‚¨å¼€å‘å®Œæ•´çš„å‰ç«¯ç•Œé¢ï¼Œå°†åŒ…æ‹¬ï¼š

### æ¥å£ç®¡ç†é¡µé¢
- [ ] å¯¼å…¥æŒ‰é’®å’Œå¯¹è¯æ¡†ï¼ˆæ”¯æŒPostman/Swaggerå¯¼å…¥ï¼‰
- [ ] å¯¼å‡ºæŒ‰é’®ï¼ˆä¸€é”®å¯¼å‡ºä¸ºPostman Collectionï¼‰
- [ ] æ–‡ä»¶ä¸Šä¼ é…ç½®ç•Œé¢ï¼ˆå¯è§†åŒ–é…ç½®fileså­—æ®µï¼‰

### æ‰§è¡Œè®°å½•é¡µé¢
- [ ] å¯¼å‡ºæŠ¥å‘ŠæŒ‰é’®ï¼ˆæ¯æ¡è®°å½•éƒ½å¯å¯¼å‡ºHTMLæŠ¥å‘Šï¼‰
- [ ] æ‰¹é‡å¯¼å‡ºåŠŸèƒ½

### æµ‹è¯•ç”¨ä¾‹ç¼–è¾‘é¡µé¢
- [ ] æ–‡ä»¶ä¸Šä¼ é…ç½®Tabé¡µï¼ˆå¯è§†åŒ–é…ç½®files_overrideï¼‰

---

## å®Œæ•´å‰ç«¯ç•Œé¢é¢„è®¡æ—¶é—´

**çº¦30åˆ†é’Ÿ-1å°æ—¶**å¯å®Œæˆæ‰€æœ‰å‰ç«¯ç•Œé¢å¼€å‘

---

## æˆ‘ç°åœ¨éœ€è¦ç»§ç»­å¼€å‘å‰ç«¯ç•Œé¢å—ï¼Ÿ

è¯·å‘Šè¯‰æˆ‘ï¼š
1. **æ˜¯** - æˆ‘ç«‹å³ç»§ç»­å¼€å‘å®Œæ•´çš„å‰ç«¯ç•Œé¢ï¼ˆéœ€è¦30åˆ†é’Ÿ-1å°æ—¶ï¼‰
2. **å¦** - æ‚¨å…ˆä½¿ç”¨ä¸Šè¿°ä¸´æ—¶æ–¹æ¡ˆæµ‹è¯•åŠŸèƒ½ï¼Œå‰ç«¯ç•Œé¢ç¨åå†åŠ 

**å»ºè®®ï¼šå…ˆæµ‹è¯•åç«¯åŠŸèƒ½æ˜¯å¦æ»¡è¶³éœ€æ±‚ï¼Œç¡®è®¤åå†å¼€å‘å‰ç«¯ç•Œé¢æ›´é«˜æ•ˆ**

